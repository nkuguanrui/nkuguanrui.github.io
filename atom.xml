<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://nkuguanrui.github.io</id>
    <title>Guan&apos;s blog</title>
    <updated>2021-01-23T14:20:25.752Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://nkuguanrui.github.io"/>
    <link rel="self" href="https://nkuguanrui.github.io/atom.xml"/>
    <subtitle>Guan&apos;s blog</subtitle>
    <logo>https://nkuguanrui.github.io/images/avatar.png</logo>
    <icon>https://nkuguanrui.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, Guan&apos;s blog</rights>
    <entry>
        <title type="html"><![CDATA[ 基于随机森林的多因子选股模型]]></title>
        <id>https://nkuguanrui.github.io/post/ji-yu-sui-ji-sen-lin-de-duo-yin-zi-xuan-gu-mo-xing/</id>
        <link href="https://nkuguanrui.github.io/post/ji-yu-sui-ji-sen-lin-de-duo-yin-zi-xuan-gu-mo-xing/">
        </link>
        <updated>2021-01-23T13:47:18.000Z</updated>
        <content type="html"><![CDATA[<p>本项目参考了华泰证券研报《人工智能选股之随机森林模型》，项目绝大内容与研报类似，项目地址为：<a href="https://github.com/nkuguanrui/portfolio_select_with_random_forest">人工智能选股之随机森林模型</a>，网址为：<a href="https://github.com/nkuguanrui/portfolio_select_with_random_forest">https://github.com/nkuguanrui/portfolio_select_with_random_forest</a>。</p>
<h2 id="随机森林">随机森林</h2>
<p>随机森林利用了Bagging思想，集合多个决策树的决策，最终达到“三个臭皮匠顶个诸葛亮”效果，如图1。有关随机森林具体做法可以参考研报和相关书籍。<br>
<img src="https://nkuguanrui.github.io/post-images/1611411277247.png" alt="" loading="lazy"></p>
<h2 id="因子选择">因子选择</h2>
<p>选择A股市场中表现较好的因子，如表1</p>
<p>表1：因子</p>
<table>
<thead>
<tr>
<th style="text-align:center">大类因子</th>
<th style="text-align:center">具体因子</th>
<th>因子描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">价值</td>
<td style="text-align:center">pe_ttm</td>
<td>市盈率，股票的价格和每股收益的比率</td>
</tr>
<tr>
<td style="text-align:center">价值</td>
<td style="text-align:center">pb_ttm</td>
<td>市净率，每股股价与每股净资产的比率</td>
</tr>
<tr>
<td style="text-align:center">价值</td>
<td style="text-align:center">ps_ttm</td>
<td>市销率，总市值与主营业务收入的比率</td>
</tr>
<tr>
<td style="text-align:center">价值</td>
<td style="text-align:center">pcf_ttm</td>
<td>市现率，股票价格与每股现金流量的比率</td>
</tr>
<tr>
<td style="text-align:center">价值</td>
<td style="text-align:center">dividendyield</td>
<td>股息率，一年的总派息额与当时市价的比例</td>
</tr>
<tr>
<td style="text-align:center">价值</td>
<td style="text-align:center">g_pe</td>
<td>净利润（TTM）同比增长率/PE_TTM</td>
</tr>
<tr>
<td style="text-align:center">成长</td>
<td style="text-align:center">sales_g</td>
<td>营业收入（TTM）同比增长率</td>
</tr>
<tr>
<td style="text-align:center">成长</td>
<td style="text-align:center">sales_g_3y</td>
<td>营业收入三年复合增长率</td>
</tr>
<tr>
<td style="text-align:center">成长</td>
<td style="text-align:center">profit_g</td>
<td>净利润（TTM）同比增长率</td>
</tr>
<tr>
<td style="text-align:center">成长</td>
<td style="text-align:center">profit_g_3y</td>
<td>净利润三年复合增长率</td>
</tr>
<tr>
<td style="text-align:center">成长</td>
<td style="text-align:center">ocf_g</td>
<td>经营性现金流（TTM）同比增长率</td>
</tr>
<tr>
<td style="text-align:center">成长</td>
<td style="text-align:center">roe_g</td>
<td>ROE（TTM）同比增长率</td>
</tr>
<tr>
<td style="text-align:center">市值</td>
<td style="text-align:center">ln_capital</td>
<td>总市值取对数</td>
</tr>
<tr>
<td style="text-align:center">动量反转</td>
<td style="text-align:center">return_Nm</td>
<td>个股最近N个月收益率，N=1,3,6,12</td>
</tr>
<tr>
<td style="text-align:center">动量反转</td>
<td style="text-align:center">wgt_return_Nm</td>
<td>个股最近N个月内用每日换手率乘以每日收益率求算术平均值N=1,3,6,12</td>
</tr>
<tr>
<td style="text-align:center">动量反转</td>
<td style="text-align:center">exp_wgt_return_Nm</td>
<td>个股最近N个月内用每日换手率乘以函数exp(-x_i/N/4)再乘以每日收益率求算术平均值，x_i为该日距离截面日的交易日的数,N=1,3,6,12</td>
</tr>
<tr>
<td style="text-align:center">波动率</td>
<td style="text-align:center">std_ff3factor_Nm</td>
<td>特质波动率——个股最近N个月内用日频收益率对FF三因子模型回归的残差的标准差，N=1,3,6,12</td>
</tr>
<tr>
<td style="text-align:center">波动率</td>
<td style="text-align:center">std_Nm</td>
<td>个股最近N个月的日收益率序列标准差，N=1,3,6,12</td>
</tr>
<tr>
<td style="text-align:center">股价</td>
<td style="text-align:center">ln_price</td>
<td>股价取对数</td>
</tr>
<tr>
<td style="text-align:center">情绪</td>
<td style="text-align:center">rating_average</td>
<td>wind评级的平均值</td>
</tr>
<tr>
<td style="text-align:center">情绪</td>
<td style="text-align:center">rating_targetprice</td>
<td>wind一致目标价/现价-1</td>
</tr>
<tr>
<td style="text-align:center">股东</td>
<td style="text-align:center">holder_avgpctchange</td>
<td>户均持股比例的同比增长率</td>
</tr>
<tr>
<td style="text-align:center">技术</td>
<td style="text-align:center">MACD</td>
<td>经典技术指标，长周期取30日，短周期取10日，计算DEA均线的周期（中周期）取15日</td>
</tr>
<tr>
<td style="text-align:center">技术</td>
<td style="text-align:center">DEA</td>
<td>经典技术指标，长周期取30日，短周期取10日，计算DEA均线的周期（中周期）取15日</td>
</tr>
<tr>
<td style="text-align:center">技术</td>
<td style="text-align:center">DIF</td>
<td>经典技术指标，长周期取30日，短周期取10日，计算DEA均线的周期（中周期）取15日</td>
</tr>
<tr>
<td style="text-align:center">财务质量因子</td>
<td style="text-align:center">roe_ttm</td>
<td>净资产收益率</td>
</tr>
<tr>
<td style="text-align:center">财务质量因子</td>
<td style="text-align:center">eps_ttm</td>
<td>每股收益</td>
</tr>
<tr>
<td style="text-align:center">财务质量因子</td>
<td style="text-align:center">ebit_ttm</td>
<td>税前利润率，税前利润比当期的销售收入</td>
</tr>
<tr>
<td style="text-align:center">杠杆</td>
<td style="text-align:center">currentratio</td>
<td>流动比率，流动负债/流动资产</td>
</tr>
<tr>
<td style="text-align:center">杠杆</td>
<td style="text-align:center">debtequityratio</td>
<td>非流动负债/净资产</td>
</tr>
<tr>
<td style="text-align:center">换手率</td>
<td style="text-align:center">bias_turn_Nm</td>
<td>个股最近N个月内日均换手率除以最近2年内日均换手率（剔除停牌、涨跌停的交易日）再减去1，N=1,3,6,12</td>
</tr>
</tbody>
</table>
<h1 id="模型构建">模型构建</h1>
<h2 id="数据处理">数据处理</h2>
<ol>
<li>数据获取
<ul>
<li>股票池：沪深300动态股票池月度数据。</li>
</ul>
<ul>
<li>回测区间：2010-01-01到2020-06-01</li>
<li>换仓期：在每个自然月最后一个交易日核算因子值，在下个自然月首个交易日按当日收盘价换仓。</li>
<li>数据来源：wind+聚宽</li>
</ul>
</li>
<li>数据预处理
<ul>
<li>缺失值：拉格朗日插值法</li>
<li>极端值：MAD中位数去极值</li>
<li>标准化：最大最小标准化</li>
</ul>
</li>
<li>特征与标签
<ul>
<li>特征：表1中50个因子</li>
<li>标签：在每个月末截面期，选取下月收益排名前 30%的股票作为正例（y = 1） ，后 30%的<br>
股票作为负例（y = 0）</li>
</ul>
</li>
</ol>
<h2 id="单测试集回测">单测试集回测</h2>
<ol>
<li>训练集测试集划分
<ul>
<li>训练集区间：2010-01-01到2016-12-31</li>
<li>测试集区间：2017-01-01到2020-05-01</li>
</ul>
</li>
<li>训练集参数寻优
<ul>
<li>KFold交叉验证</li>
<li>超参数：n_estimators;max_features;min_samples_leaf;min_samples_split</li>
</ul>
</li>
<li>测试集回测
<ul>
<li>长时间跨度测试集回测</li>
<li>模型参数固定，可能会失效</li>
</ul>
</li>
</ol>
<h2 id="回测指标">回测指标</h2>
<ul>
<li>年化收益率</li>
<li>年化波动率</li>
<li>夏普比率</li>
<li>最大回撤</li>
<li>IR信息比率</li>
<li>超额收益</li>
<li>净值</li>
</ul>
<h2 id="滚动分层回测多测试集回测">滚动分层回测（多测试集回测）</h2>
<ol>
<li>行业中性策略<br>
将随机森林预测值是为单因子，分别从各个行业中选出预测值排名靠前的N只股票等权配置。</li>
<li>等权重策略<br>
将随机森林预测值是为单因子，直接从股票池中选取预测值排名靠前的N只股票等权配置。</li>
</ol>
<h2 id="实证研究">实证研究</h2>
<p>分别进行滚动行业中性策略，滚动等权重策略，行业中性单测试集策略，等权重单测试集策略。</p>
<ol>
<li>滚动等权重策略
<ul>
<li>滚动窗口长度t：12，18，24</li>
<li>股票池N：10，20，50</li>
<li>回测区间：2017-2020</li>
<li>手续费：0.15%</li>
</ul>
</li>
<li>滚动行业中性策略
<ul>
<li>滚动窗口长度t：12，18，24</li>
<li>单行业股票池N：2，5，10</li>
<li>回测区间：2017-2020</li>
<li>手续费：0.15%</li>
</ul>
</li>
<li>等权重单测试集策略
<ul>
<li>股票池N：10，20，50</li>
<li>回测区间：2017-2020</li>
<li>手续费：0.15%</li>
</ul>
</li>
<li>行业中性单测试集策略
<ul>
<li>单行业股票池N：2，5，10</li>
<li>回测区间：2017-2020</li>
<li>手续费：0.15%</li>
</ul>
</li>
</ol>
<h2 id="实证结论">实证结论</h2>
<p>等权重策略随机森林选股策略可以获得稳定的超额收益，行业中性策略效果不明显，下面展示滚动等权重策略（t:12;N:10)，单测试集等权重策略（N:10)和HS300指数的净值走势，如图2。注：策略手续费0.15%，指数手续费0%。<br>
<img src="https://nkuguanrui.github.io/post-images/1611411294127.png" alt="" loading="lazy"></p>
<h2 id="代码和数据">代码和数据</h2>
<p>项目地址为：<a href="https://github.com/nkuguanrui/portfolio_select_with_random_forest">人工智能选股之随机森林模型</a>，网址为：<a href="https://github.com/nkuguanrui/portfolio_select_with_random_forest">https://github.com/nkuguanrui/portfolio_select_with_random_forest</a><br>
<strong>未经授权不得转载或转载请注明出处</strong></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ 中国波指（000188）编制（python）]]></title>
        <id>https://nkuguanrui.github.io/post/zhong-guo-bo-zhi-000188bian-zhi-python/</id>
        <link href="https://nkuguanrui.github.io/post/zhong-guo-bo-zhi-000188bian-zhi-python/">
        </link>
        <updated>2021-01-23T13:36:37.000Z</updated>
        <content type="html"><![CDATA[<p>中国波指编制；中国波动率指数；复现中国波指000188；python；</p>
<h1 id="中国波指介绍">中国波指介绍</h1>
<p>上证 50 ETF 波动率指数是基于上海证券交易所挂牌的 50 ETF 期权合约编制而成，反映投资者对未来 30 天 50 ETF 波动率的预期。上证 50 ETF 波动率指数不仅是反映投资者情绪的重要指标，也是衍生产品的重要标的，可作为投资者管控风险的有力工具。由于种种原因，中国波指在2018年停止发布本。项目目的是严格按照官方发布的指数编制方法重新复现波动率指数，数据和代码详见项目主页<a href="https://github.com/nkuguanrui/ivx">中国波指python编制</a>，网址：<a href="https://github.com/nkuguanrui/ivx">https://github.com/nkuguanrui/ivx</a>。</p>
<ul>
<li>指数名称：上证 50 ETF 波动率指数</li>
<li>指数简称：中国波指</li>
<li>英文名称：SSE 50 ETF Volatility Index</li>
<li>英文简称：iVX</li>
<li>指数代码：000188</li>
</ul>
<h2 id="计算方法">计算方法</h2>
<p>上证 50 ETF 波动率指数是基于方差互换原理，采用上证 50 ETF 期权相关数据计算而得。具体计算方法参考中证指数有限公司分布的《上证50ETF波动率指数编制方案》。</p>
<h2 id="指数复现">指数复现</h2>
<p>由于种种原因，中国波指在2018年官方停止发布，本项目利用python和期权数据，严格按照中国波指官方编制方案，对中国波指进行复制，目的是为了可以获得最新的中国波指数据，方面投资者进行风险管控。</p>
<h3 id="数据来源">数据来源</h3>
<p>wind数据库，上证50ETF期权日度数据</p>
<h3 id="方法">方法</h3>
<p>python+《上证50ETF波动率指数编制方案》</p>
<h3 id="结论">结论</h3>
<p>复现的波动率指数和中国波指相似度高达98.3%，达到实践可用水平,如图。<br>
<img src="https://nkuguanrui.github.io/post-images/1611409293578.png" alt="" loading="lazy"></p>
<h1 id="数据和代码">数据和代码</h1>
<p>数据和代码详见项目主页<a href="https://github.com/nkuguanrui/ivx">中国波指python编制</a>,网址：<a href="https://github.com/nkuguanrui/ivx">https://github.com/nkuguanrui/ivx</a>。<br>
<strong>未经授权不得转载或转载请注明出处</strong></p>
]]></content>
    </entry>
</feed>